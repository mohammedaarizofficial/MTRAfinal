@page
@model LandTransportModel
@using MTRADashboard.Models
@{
    ViewData["Title"] = "Material Transport Request";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Material Transport System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <style>
        .section-header {
            background: linear-gradient(135deg, #4285f4 0%, #5f7de2 100%);
            color: white;
            margin-bottom: 0;
            border-radius: 0.375rem 0.375rem 0 0;
        }
        .form-section {
            margin-bottom: 3rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border-radius: 0.375rem;
        }
        .form-section .card-body {
            padding: 2rem;
        }
        .section-divider {
            margin: 3rem 0;
            border: 0;
            height: 2px;
            background: linear-gradient(to right, transparent, #667eea, transparent);
        }
        .required-field::after {
            content: "*";
            color: #dc3545;
            margin-left: 4px;
        }
        .form-label {
            font-weight: 500;
            color: #495057;
            margin-bottom: 0.5rem;
        }
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 500;
            border-radius: 0.375rem;
        }
        .btn-submit:hover {
            transform: translateY(-1px);
            box-shadow: 0 0.25rem 0.5rem rgba(102, 126, 234, 0.3);
        }
        .page-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .table-input {
            width: 100%;
            border: none;
            background: transparent;
        }
        .table-input:focus {
            outline: none;
            box-shadow: none;
            border-bottom: 1px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-1 pb-1 mb-3">
        <h1 class="text-center w-100">
            <span class="fw-bold display-4" style="color: #4285f4;">MTRA</span>
            <br>
            <small class="text-muted fs-6">MATERIAL TRANSPORT REQUEST SYSTEM</small>
            <hr class="w-25 mx-auto" style="color: #4285f4; height: 3px;">
        </h1>
    </div>

    <div class="container">
        <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
            <!-- Section 1: Employee & Request Details -->
            <div class="form-section">
                <div class="card">
                    <div class="card-header section-header">
                        <h3 class="mb-0 py-2">
                            <i class="fas fa-clipboard-list me-2"></i>
                            Section 1: Employee & Request Details
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Employee Name</label>
                                <input asp-for="TransportRequest.EmpName" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Designation</label>
                                <input asp-for="TransportRequest.Designation" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Department</label>
                                <input asp-for="TransportRequest.Department" class="form-control" required />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Contact Number</label>
                                <input asp-for="TransportRequest.ContactNumber" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Email</label>
                                <input asp-for="TransportRequest.Email" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">PO/SWO No</label>
                                <input asp-for="TransportRequest.PO_SWO_NO" class="form-control" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Request Date</label>
                                <input asp-for="TransportRequest.RequestDate" type="date" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Request Type</label>
                                <input asp-for="TransportRequest.RequestType" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Priority</label>
                                <input asp-for="TransportRequest.Priority" class="form-control" required />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Site</label>
                                <input asp-for="TransportRequest.Site" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Division</label>
                                <input asp-for="TransportRequest.Division" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Process Type</label>
                                <input asp-for="TransportRequest.ProcessType" class="form-control" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">BackLoad</label>
                                <input asp-for="TransportRequest.BackLoad" type="checkbox" class="form-check-input" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">From Site</label>
                                <input asp-for="TransportRequest.FromSite" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Required Date</label>
                                <input asp-for="TransportRequest.RequiredDate" type="date" class="form-control" required />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Divider -->
            <hr class="section-divider" />

            <!-- Section 2: Assets Table -->
            <div class="form-section">
                <div class="card">
                    <div class="card-header section-header d-flex justify-content-between align-items-center">
                        <h3 class="mb-0 py-2">
                            <i class="fas fa-boxes me-2"></i>
                            Section 2: Asset Details
                        </h3>
                        <button type="button" class="btn btn-light btn-sm" onclick="addAssetRow()">
                            <i class="fas fa-plus"></i> Add Asset
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle" id="assetsTable">
                                <thead class="table-light">
                                    <tr>
                                        <th>Functional Location</th>
                                        <th>Equipment No</th>
                                        <th>Asset Value</th>
                                        <th>Asset Description</th>
                                        <th>Asset Remarks</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Asset rows will be dynamically added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Divider -->
            <hr class="section-divider" />

            <!-- Section 3: Materials Table -->
            <div class="form-section">
                <div class="card">
                    <div class="card-header section-header d-flex justify-content-between align-items-center">
                        <h3 class="mb-0 py-2">
                            <i class="fas fa-cubes me-2"></i>
                            Section 3: Material Details
                        </h3>
                        <button type="button" class="btn btn-light btn-sm" onclick="addMaterialRow()">
                            <i class="fas fa-plus"></i> Add Material
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle" id="materialsTable">
                                <thead class="table-light">
                                    <tr>
                                        <th>Material Description</th>
                                        <th>Material Value</th>
                                        <th>Material Code</th>
                                        <th>WPS Code</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Material rows will be dynamically added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Divider -->
            <hr class="section-divider" />

            <!-- Section 4: Agreement, Accounting, Delivery -->
            <div class="form-section">
                <div class="card">
                    <div class="card-header section-header">
                        <h3 class="mb-0 py-2">
                            <i class="fas fa-file-contract me-2"></i>
                            Section 4: Agreement, Accounting, Delivery
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Agreement No</label>
                                <input asp-for="TransportRequest.AgreementNo" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Agreement Remarks</label>
                                <input asp-for="TransportRequest.AgreementRemarks" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">GL Account Code</label>
                                <input asp-for="TransportRequest.GLAccountCode" class="form-control" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">WBS Code</label>
                                <input asp-for="TransportRequest.WBSCode" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Cost Center</label>
                                <input asp-for="TransportRequest.CostCenter" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Account Remarks</label>
                                <input asp-for="TransportRequest.AccountRemarks" class="form-control" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Loading Address</label>
                                <textarea asp-for="TransportRequest.LoadingAddress" class="form-control" required></textarea>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Delivery Address</label>
                                <textarea asp-for="TransportRequest.DeliveryAddress" class="form-control" required></textarea>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Contact Name</label>
                                <input asp-for="TransportRequest.ContactName" class="form-control" required />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Contact Email</label>
                                <input asp-for="TransportRequest.ContactEmail" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label required-field">Contact Mobile</label>
                                <input asp-for="TransportRequest.ContactMob" class="form-control" required />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Site Map File</label>
                                <input asp-for="TransportRequest.SiteMapFile" type="file" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="row">
                <div class="col-12 text-center">
                    <button type="submit" class="btn btn-primary btn-submit btn-lg mb-3" style="background: linear-gradient(135deg, #4285f4 0%, #5f7de2 100%);">
                        <i class="fas fa-paper-plane me-2"></i>
                        Submit Transport Request
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script>
        // Dynamic Asset Table
        function addAssetRow() {
            var table = document.getElementById('assetsTable').getElementsByTagName('tbody')[0];
            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount);
            row.innerHTML = `
                <td><input name="Assets[${rowCount}].FunctionalLoc" class="table-input" required /></td>
                <td><input name="Assets[${rowCount}].EquipmentNo" class="table-input" required /></td>
                <td><input name="Assets[${rowCount}].AssetValue" type="number" step="0.01" min="0" class="table-input" required /></td>
                <td><input name="Assets[${rowCount}].AssetDesc" class="table-input" /></td>
                <td><input name="Assets[${rowCount}].AssetRemarks" class="table-input" /></td>
                <td><button type="button" class="btn btn-danger btn-sm" onclick="removeAssetRow(this)"><i class="fas fa-trash"></i></button></td>
            `;
        }
        function removeAssetRow(btn) {
            var row = btn.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }
        // Dynamic Material Table
        function addMaterialRow() {
            var table = document.getElementById('materialsTable').getElementsByTagName('tbody')[0];
            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount);
            row.innerHTML = `
                <td><input name="Materials[${rowCount}].MaterialDesc" class="table-input" required /></td>
                <td><input name="Materials[${rowCount}].MaterialValue" type="number" step="0.01" min="0" class="table-input" required /></td>
                <td><input name="Materials[${rowCount}].MaterialCode" class="table-input" required /></td>
                <td><input name="Materials[${rowCount}].WPSCode" class="table-input" /></td>
                <td><button type="button" class="btn btn-danger btn-sm" onclick="removeMaterialRow(this)"><i class="fas fa-trash"></i></button></td>
            `;
        }
        function removeMaterialRow(btn) {
            var row = btn.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }
    </script>
    <!-- Form Validation Script -->
    <script>
        // Bootstrap form validation
        (function() {
            'use strict';
            window.addEventListener('load', function() {
                var forms = document.getElementsByClassName('needs-validation');
                var validation = Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
</body>
</html>